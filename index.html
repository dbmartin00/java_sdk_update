<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Image</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/uuid/8.3.2/uuid.min.js"></script>
    <script src="https://cdn.split.io/sdk/split-10.25.2.min.js"></script>
</head>
<body>
    <div>
      <img id="theImage" width="50%" src="https://i0.wp.com/hellersite.com/wp-content/uploads/images/construction-fundamentals.jpeg?fit=1024%2C585&ssl=1"/>
    </div>

    <script>
        const id = uuid.v4();

        var factory = splitio({ 
          core: {
            authorizationKey: '2d20dfejlhn8ihi1tla2e27bs4ishqa54nt5',
            key: id 
            },
          scheduler: {
            eventPushRate: 1
          }
        });

        var client = factory.client();

        draw();

        client.on(client.Event.SDK_UPDATE, () => {
            console.log('SDK_UPDATE!')
            draw();
        })

        function draw() {
            console.log('draw!');
            axios.get('http://localhost:8080/api/demo/image/dmartin') //${id})
            .then(response => {
                //console.log('response.data', response.data);
                const image = response.data.url;
                console.log('image', image);
                document.getElementById('theImage').src = image;
            })
            .catch(error => {
                console.error('Error fetching image:', error);
            });
        }
    </script>
</body>
</html>

